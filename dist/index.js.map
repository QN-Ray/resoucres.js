{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["/**\n * 输入一个url, 则返回之后所有的key 和对应的value 的一个集合.\n * 他只能够应对 search (?) 后的内容返回\n * @param {Object} url\t当前输入的 url\n */\nconst getSearch = (url) => {\n    let resp = {};\n    url.split('?').pop().split('&').map(item => {\n        let [key,val] = item.split('=');\n        val !== undefined && (resp[key] = resp[key] || []) && resp[key].push(val);\n    });\n    Object.keys(resp).forEach(name => resp[name].length === 1 && (resp[name] = resp[name].join('')));\n    return resp;\n}\n\n/**\n * 根据传入的 url , callKeys 等计算可以跳转的页面.\n * @param {String} url\t\t\t\t\t\t\t\t\t传入的url.\n * @param {Object} callKeys\t\t\t\t\t\t\t如有呼起需要做的操作\n * \n*/\nconst getRedirectPath = (url='', callKeys={}) => {\n\turl = url.split('&');\n\tlet filterPath = Object.keys(callKeys).map(key=>{\n\t\tlet isMatched = true;\n\t\tkey.split('&').map(item=>{\n\t\t\tisMatched = Boolean(~url.indexOf(decodeURIComponent(item)));\n\t\t});\n\t\treturn isMatched ? callKeys[key] : '';\n\t});\n\n\treturn filterPath.pop() || '';\n};\n\n\n\n// 缓存的方式\nconst storageActions = {\n\tsession(key,value){\n\t\twindow.sessionStorage.setItem(key, decodeURIComponent(value));\n\t},\n\tlocal(key,value){\n\t\twindow.localStorage.setItem(key, decodeURIComponent(value));\n\t}\n}\n\n// 页面跳转处理缓存\nconst init = (opts={}) => {\n\tlet {\n\t\tcallKeys = {} ,\n\t\tcacheMap = {} ,\n\t\tonRedirect = ()=>{},\n\t\tcurUrl = location.href ,\n\t\thash = location.hash,\n\t} = opts;\n\n\tlet search = getSearch(hash);\n\n\t// 缓存\n\tObject.keys(cacheMap).forEach(name =>{\n\t\tlet opts = cacheMap[name];\n\t\tif( typeof opts === 'string') opts = {rename : opts};\n\n\t\topts = Object.assign({storage:'session'} , opts);\n\n\t\tif(!search[name]) return console.error('[error]:pageload cache error ' , name );\n\n\t\ttypeof opts.storage === 'function' ? \n\t\topts.storage(rename || name , search[name]) :\n\t\tstorageActions[opts.storage](rename || name , search[name]);\n\t});\n\n\tlet redirect = getRedirectPath(curUrl,callKeys) || callKeys['*'];\n\n\tif(redirect){\n\t\tredirect = redirect.replace(/\\{(\\S+)\\}/g , (a , param) => search[param]);\n\t\tonRedirect && onRedirect();\n\t\treturn location.href = redirect;\n\t}\n}\n\nmodule.exports = {\n\tinit,\n\tgetSearch,\n\tgetRedirectPath\n}"],"names":[],"mappings":"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"}